!function(n){"object"==typeof exports?module.exports=n():"function"==typeof define&&define.amd?define(n):ENTITY_WHARF=n()}(function(){var n="$:?:$",t=function(t){return"object"==typeof t?"number"==typeof t.length&&"[object Array]"==Object.prototype.toString.call(t)?n+"array":n+"object":"function"==typeof t?n+"function":t},r=function(r,e){return r+n+t(e)},e=function(n){return!!n&&"object"==typeof n&&n.constructor===Object},o=Object.keys,u=function(n,t){return n.hasOwnProperty(t)},c=function(n,t,r){u(n,t)||(n[t]={}),n[t][r]=!0},f=function(n,t,r){u(n,t)&&delete n[t][r]};return function(){var n=function(){var n=0;return function(){return n++,n+""}}(),i={},a={},p={},h={},l=function(n){return u(i,n)},v=function(n,u){return l(n)&&e(u)?(o(u).forEach(function(e){var o=u[e];i[n][e]=o,c(a,e,n),c(p,t(o),n),c(h,r(e,o),n)}),!0):!1};return{get:function(n){return l(n)?i[n]:null},add:function(t){var r=n();return i[r]={},v(r,t)?r:(delete i[r],!1)},set:v,remove:function(n){return l(n)?(o(i[n]).forEach(function(e){f(a,e,n),f(p,t(i[n][e]),n),f(h,r(e,i[n][e]),n)}),delete i[n],!0):!1},q:function(n){if(!e(n))return o(i);var c=n.e||[],f=n.a||[],l=n.v||[],v=n.av||[],y=[c];f.forEach(function(n){y.push(o(a[n]||{}))}),l.forEach(function(n){y.push(o(p[t(n)]||{}))}),v.forEach(function(n){var t=n[0],e=n[1];y.push(o(h[r(t,e)]||{}))});var d=0,b={};return y.forEach(function(n){0!==n.length&&(d++,n.forEach(function(n){u(b,n)||(b[n]=0),b[n]++}))}),o(b).filter(function(n){return b[n]===d})}}}});